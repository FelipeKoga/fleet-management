<div class="container">
  <h2 mat-dialog-title>
    <span *ngIf="data.type === 'INSERT'">Criação de usuário</span>
    <span *ngIf="data.type === 'UPDATE'">Atualização de usuário</span>
    <span *ngIf="data.type === 'DELETE'">Exclusão de usuário</span>
  </h2>
  <ng-container *ngIf="data.type === 'DELETE'; else elseTemplate">
    <p style="font-size: 16px; flex: 1">
      Você tem certeza que deseja excluir o usuário {{ data.user.name }}
    </p>
    <mat-dialog-actions align="end">
      <button [disabled]="isLoading" mat-button mat-dialog-close>
        Cancelar
      </button>
      <button
        [disabled]="(state$ | async).isLoading"
        color="warn"
        (click)="delete()"
        mat-stroked-button
      >
        <ng-container *ngIf="(state$ | async).isLoading; else elseTemplate">
          <mat-spinner
            color="warn"
            style="margin: 2px"
            [diameter]="30"
          ></mat-spinner>
        </ng-container>
        <ng-template #elseTemplate> Confirmar </ng-template>
      </button>
    </mat-dialog-actions>
  </ng-container>
  <ng-template #elseTemplate>
    <form class="form" [formGroup]="form" (ngSubmit)="submit()">
      <mat-form-field appearance="outline">
        <mat-label>Nome completo</mat-label>
        <input formControlName="name" matInput />
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>E-mail</mat-label>
        <input formControlName="email" matInput />
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>Telefone</mat-label>
        <input formControlName="phone" matInput />
      </mat-form-field>
      <mat-dialog-actions align="end">
        <button
          [disabled]="(state$ | async).isLoading"
          mat-button
          mat-dialog-close
        >
          Cancelar
        </button>
        <button
          color="primary"
          mat-stroked-button
          type="submit"
          [disabled]="form.invalid"
        >
          <ng-container *ngIf="(state$ | async).isLoading; else elseTemplate">
            <mat-spinner
              color="primary"
              style="margin: 2px"
              [diameter]="30"
            ></mat-spinner>
          </ng-container>
          <ng-template #elseTemplate> Salvar </ng-template>
        </button>
      </mat-dialog-actions>
    </form>
  </ng-template>
</div>
